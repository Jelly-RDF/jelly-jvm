syntax = "proto3";

import "scalapb/scalapb.proto";

package pl.ostrzyciel.jelly.core.proto;

option (scalapb.options) = {
  scope: PACKAGE
  flat_package: true
  package_name: "pl.ostrzyciel.jelly.core.proto"
  // Disabling lenses and getters makes the generated code a bit smaller
  lenses: false
  getters: false
  // Disabling this can substantially improve performance
  preserve_unknown_fields: false
  field_transformations: [
    // Don't box RdfTerm and RdfGraph in Option[] to reduce heap pressure and speed things up a bit
    {
      when: {
        type: TYPE_MESSAGE
        type_name: ".pl.ostrzyciel.jelly.core.proto.RdfTerm"
      }
      // TODO: check if it would be faster to use required instead of no_box
      set: {[scalapb.field] {no_box: true}}
    },
    {
      when: {
        type: TYPE_MESSAGE
        type_name: ".pl.ostrzyciel.jelly.core.proto.RdfGraph"
      }
      set: {[scalapb.field] {no_box: true}}
    }
  ]
};

option java_package = "pl.ostrzyciel.jelly.core.proto";

// Optimize for speed
option optimize_for = SPEED;
option java_multiple_files = true;
